<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transfer topic model and visualization â€¢ CellFunTopic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Transfer topic model and visualization">
<meta property="og:description" content="CellFunTopic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CellFunTopic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CellFunTopic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pre-processing.html">Pre-processing</a>
    </li>
    <li>
      <a href="../articles/visualization_gsea.html">Visualization of GSEA Result</a>
    </li>
    <li>
      <a href="../articles/topicmodel_visualization.html">Topic modeling and visualization</a>
    </li>
    <li>
      <a href="../articles/transfer_topicmodel.html">Transfer topic model and visualization</a>
    </li>
    <li>
      <a href="../articles/transfer_annotation.html">Transfer annotation from reference to query data</a>
    </li>
    <li>
      <a href="../articles/shiny_app.html">Visualize in Built-in Shiny APP</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/xiaobaicainiao666/CellFunTopic/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="transfer_topicmodel_files/header-attrs-2.14/header-attrs.js"></script><script src="transfer_topicmodel_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="transfer_topicmodel_files/d3-4.5.0/d3.min.js"></script><script src="transfer_topicmodel_files/sankey-1/sankey.js"></script><script src="transfer_topicmodel_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Transfer topic model and visualization</h1>
            
            <h4 class="date">2022-09-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xiaobaicainiao666/CellFunTopic/blob/master/vignettes/transfer_topicmodel.Rmd"><code>vignettes/transfer_topicmodel.Rmd</code></a></small>
      <div class="hidden name"><code>transfer_topicmodel.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/xiaobaicainiao666/CellFunTopic">CellFunTopic</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">magrittr</span><span class="op">)</span></code></pre></div>
<div id="reference-topic-models" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-topic-models" class="anchor"></a>Reference topic models</h2>
<p>CellFunTopic provides built-in reference topic models for users to
take advantage of large landscape datasets such as the human cell
landscape (HCL) and the mouse cell atlas (MCA).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">HCL_ldaOut</span>
<span class="op">?</span><span class="va">MCA_ldaOut</span></code></pre></div>
<p>CellFunTopic also provides methods for users to make their own
reference topic models.</p>
</div>
<div id="make-a-reference-topic-model-and-transfer" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-reference-topic-model-and-transfer" class="anchor"></a>Make a reference topic model and transfer</h2>
<p>Let us take <code>pbmc3k.final</code> as example to show how to make
a reference topic model and transfer. We take the original one as the
reference data, and re-cluster it as the query data.</p>
<p>Make a reference topic model out of <code>pbmc3k.final</code> with
the ground-truth cell type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">'pbmc3k.final'</span>, package <span class="op">=</span> <span class="st">"pbmc3k.SeuratData"</span><span class="op">)</span>
<span class="va">reference_SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readData.html">readData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbmc3k.final</span>, type <span class="op">=</span> <span class="st">'Seurat'</span>, species <span class="op">=</span> <span class="st">"Homo sapiens"</span><span class="op">)</span>
<span class="va">reference_SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DetectGeneIDtype.html">DetectGeneIDtype</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span><span class="op">)</span>
<span class="va">SeuratObj.markers</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/FindAllMarkers.html">FindAllMarkers</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span>, only.pos <span class="op">=</span> <span class="cn">TRUE</span>, min.pct <span class="op">=</span> <span class="fl">0.0001</span>, logfc.threshold <span class="op">=</span> <span class="fl">0.0001</span>, return.thresh<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>
<span class="fu">slot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">reference_SeuratObj</span>, name <span class="op">=</span> <span class="st">'misc'</span><span class="op">)</span><span class="op">[[</span><span class="st">"Allmarkers"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">SeuratObj.markers</span>
<span class="va">reference_SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunGSEA.html">RunGSEA</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span>, by <span class="op">=</span> <span class="st">'GO'</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html">Idents</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">reference_SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runLDA.html">runLDA</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span>, by <span class="op">=</span> <span class="st">"GO"</span>, k <span class="op">=</span> <span class="va">k</span>, method <span class="op">=</span> <span class="st">"VEM"</span>, SEED <span class="op">=</span> <span class="fl">1234</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html">Idents</a></span><span class="op">(</span><span class="va">reference_SeuratObj</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Naive CD4 T Memory CD4 T   CD14+ Mono            B        CD8 T FCGR3A+ Mono 
##          697          483          480          344          271          162 
##           NK           DC     Platelet 
##          155           32           14</code></pre>
<p>Re-analyze and re-cluster <code>pbmc3k.final</code> as the query
data, each cell owns a new cluster identity.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readData.html">readData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbmc3k.final</span>, type <span class="op">=</span> <span class="st">'Seurat'</span>, species <span class="op">=</span> <span class="st">"Homo sapiens"</span><span class="op">)</span>
<span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CalMTpercent.html">CalMTpercent</a></span><span class="op">(</span><span class="va">SeuratObj</span>, by <span class="op">=</span> <span class="st">"use_internal_data"</span><span class="op">)</span>
<span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QCfun.html">QCfun</a></span><span class="op">(</span><span class="va">SeuratObj</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunSeurat.html">RunSeurat</a></span><span class="op">(</span><span class="va">SeuratObj</span>, nPCs <span class="op">=</span> <span class="fl">10</span>, resolution <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunGSEA.html">RunGSEA</a></span><span class="op">(</span><span class="va">SeuratObj</span>, by <span class="op">=</span> <span class="st">'GO'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check the new clustering</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html">Idents</a></span><span class="op">(</span><span class="va">SeuratObj</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   0   1   2   3   4   5   6   7   8   9 
## 537 460 325 252 220 159 143 141 140 134</code></pre>
<p>Transfer topic model from reference data to query data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ref_ldaOUt</span> <span class="op">&lt;-</span> <span class="va">reference_SeuratObj</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">ldaOut</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transfer_LDA.html">transfer_LDA</a></span><span class="op">(</span>query_SeuratObj <span class="op">=</span> <span class="va">SeuratObj</span>, ref_ldaOUt <span class="op">=</span> <span class="va">ref_ldaOUt</span>, by <span class="op">=</span> <span class="st">"GO"</span><span class="op">)</span></code></pre></div>
</div>
<div id="visualize-transferred-model" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-transferred-model" class="anchor"></a>Visualize transferred model</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">SeuratObj</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">dist</span>
<span class="va">gammaDF</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">topics</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">set_colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"document"</span>, <span class="st">"topic"</span>, <span class="st">"gamma"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_sankey.html">plot_sankey</a></span><span class="op">(</span><span class="va">gammaDF</span>, topn<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-4841b265f04ac361809c" style="width:800px;height:600px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4841b265f04ac361809c">{"x":{"links":{"source":[3,4,7,0,5,9,2,1,6,8],"target":[10,10,11,12,13,13,14,15,15,16],"value":[0.69709575770648,0.707537832158022,0.560277500122771,0.716691803345141,0.55890829679742,0.633647735217932,0.853007038074221,0.797392894298069,0.721059301442405,0.701440405818133],"group":["Topic_1","Topic_1","Topic_2","Topic_3","Topic_5","Topic_5","Topic_6","Topic_8","Topic_8","Topic_9"]},"nodes":{"name":["0","1","2","3","4","5","6","7","8","9","Topic_1","Topic_2","Topic_3","Topic_5","Topic_6","Topic_8","Topic_9"],"group":["0","1","2","3","4","5","6","7","8","9","Topic_1","Topic_2","Topic_3","Topic_5","Topic_6","Topic_8","Topic_9"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":"topic","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mm</span> <span class="op">&lt;-</span> <span class="va">dist</span><span class="op">$</span><span class="va">topics</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Topic '</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">)</span>
<span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op">(</span><span class="va">mm</span>, cluster_rows <span class="op">=</span> <span class="cn">T</span>, cluster_cols <span class="op">=</span> <span class="cn">T</span>, angle_col <span class="op">=</span> <span class="st">"0"</span>, main <span class="op">=</span> <span class="st">"probability between topic and cluster"</span>,
                   color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">9</span>,name<span class="op">=</span><span class="st">"OrRd"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,
                   fontsize_row <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<p><img src="transfer_topicmodel_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="visualize-correlation-or-comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-correlation-or-comparison" class="anchor"></a>Visualize correlation or comparison</h2>
<p>CellFunTopic provides a few methods to visualize correlation or
comparison between reference data and query data. For better comparison,
we identify the cell types of query data based on ground-truth identity
of each cell.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SeuratObj</span><span class="op">$</span><span class="va">seurat_annotations</span>, <span class="va">SeuratObj</span><span class="op">$</span><span class="va">seurat_clusters</span><span class="op">)</span>
<span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">mm</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">topics</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nn</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">topics</span><span class="op">)</span><span class="op">]</span>

<span class="fu"><a href="../reference/sankey_comparison.html">sankey_comparison</a></span><span class="op">(</span>ldaOut<span class="op">=</span><span class="va">ref_ldaOUt</span>, dist<span class="op">=</span><span class="va">dist</span>, a_prefix<span class="op">=</span><span class="st">"reference_"</span>, b_prefix<span class="op">=</span><span class="st">"query_"</span>, height<span class="op">=</span><span class="fl">800</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b846237a3f974cd8e3e7" style="width:800px;height:800px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-b846237a3f974cd8e3e7">{"x":{"links":{"source":[1,7,5,2,0,3,8,6,4,9,10,11,12,13,15,14],"target":[10,15,13,11,9,9,16,14,12,17,18,19,20,21,23,22],"value":[0.999971152916276,0.641833162163222,0.999969356943293,0.999975946174153,0.999944072655296,0.580412295314719,0.99991416091789,0.999955069049232,0.799421181349954,0.853007038074221,0.707537832158022,0.633647735217932,0.701440405818133,0.716691803345141,0.560277500122771,0.797392894298069],"group":["Topic_1","Topic_2","Topic_3","Topic_5","Topic_6","Topic_6","Topic_7","Topic_8","Topic_9","Topic_6","Topic_1","Topic_5","Topic_9","Topic_3","Topic_2","Topic_8"]},"nodes":{"name":["reference_B","reference_CD14+ Mono","reference_CD8 T","reference_DC","reference_FCGR3A+ Mono","reference_Memory CD4 T","reference_Naive CD4 T","reference_NK","reference_Platelet","Topic_6","Topic_1","Topic_5","Topic_9","Topic_3","Topic_8","Topic_2","Topic_7","query_B","query_CD14+ Mono","query_CD8 T","query_FCGR3A+ Mono","query_Memory CD4 T","query_Naive CD4 T","query_NK"],"group":["reference_B","reference_CD14+ Mono","reference_CD8 T","reference_DC","reference_FCGR3A+ Mono","reference_Memory CD4 T","reference_Naive CD4 T","reference_NK","reference_Platelet","Topic_6","Topic_1","Topic_5","Topic_9","Topic_3","Topic_8","Topic_2","Topic_7","query_B","query_CD14+ Mono","query_CD8 T","query_FCGR3A+ Mono","query_Memory CD4 T","query_Naive CD4 T","query_NK"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":"linkcolor","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cosine_network_cluster2.html">cosine_network_cluster2</a></span><span class="op">(</span>ldaOut<span class="op">=</span><span class="va">ref_ldaOUt</span>, dist<span class="op">=</span><span class="va">dist</span>, a_prefix<span class="op">=</span><span class="st">"reference_"</span>, b_prefix<span class="op">=</span><span class="st">"query_"</span>,
                        layout<span class="op">=</span><span class="st">"fr"</span>, cos_sim_thresh<span class="op">=</span><span class="fl">0.5</span>, radius<span class="op">=</span><span class="fl">0.1</span>, text_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="transfer_topicmodel_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cosine_heatmap2.html">cosine_heatmap2</a></span><span class="op">(</span>ldaOut<span class="op">=</span><span class="va">ref_ldaOUt</span>, dist<span class="op">=</span><span class="va">dist</span>, a_prefix<span class="op">=</span><span class="st">"reference_"</span>, b_prefix<span class="op">=</span><span class="st">"query_"</span>, method<span class="op">=</span><span class="st">"cosine"</span><span class="op">)</span></code></pre></div>
<p><img src="transfer_topicmodel_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cosine_hive.html">cosine_hive</a></span><span class="op">(</span>ldaOut<span class="op">=</span><span class="va">ref_ldaOUt</span>, dist<span class="op">=</span><span class="va">dist</span>, a_prefix<span class="op">=</span><span class="st">"reference_"</span>, b_prefix<span class="op">=</span><span class="st">"query_"</span><span class="op">)</span></code></pre></div>
<p><img src="transfer_topicmodel_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shanni Cao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
