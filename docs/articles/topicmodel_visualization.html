<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Topic modeling and visualization • CellFunTopic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Topic modeling and visualization">
<meta property="og:description" content="CellFunTopic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CellFunTopic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CellFunTopic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pre-processing.html">Pre-processing</a>
    </li>
    <li>
      <a href="../articles/visualization_gsea.html">Visualization of GSEA Result</a>
    </li>
    <li>
      <a href="../articles/topicmodel_visualization.html">Topic modeling and visualization</a>
    </li>
    <li>
      <a href="../articles/transfer_topicmodel.html">Transfer topic model and visualization</a>
    </li>
    <li>
      <a href="../articles/transfer_annotation.html">Transfer annotation from reference to query data</a>
    </li>
    <li>
      <a href="../articles/shiny_app.html">Visualize in Built-in Shiny APP</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/xiaobaicainiao666/CellFunTopic/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="topicmodel_visualization_files/header-attrs-2.14/header-attrs.js"></script><script src="topicmodel_visualization_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="topicmodel_visualization_files/echarts4r-4.8.0/echarts-en.min.js"></script><script src="topicmodel_visualization_files/echarts4r-4.8.0/ecStat.min.js"></script><script src="topicmodel_visualization_files/echarts4r-4.8.0/dataTool.min.js"></script><script src="topicmodel_visualization_files/echarts4r-binding-0.3.3/echarts4r.js"></script><script src="topicmodel_visualization_files/echarts-gl-1.1.2/echarts-gl.min.js"></script><script src="topicmodel_visualization_files/d3-4.5.0/d3.min.js"></script><script src="topicmodel_visualization_files/sankey-1/sankey.js"></script><script src="topicmodel_visualization_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><link href="topicmodel_visualization_files/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="topicmodel_visualization_files/wordcloud2-0.0.1/wordcloud2-all.js"></script><script src="topicmodel_visualization_files/wordcloud2-0.0.1/hover.js"></script><script src="topicmodel_visualization_files/wordcloud2-binding-0.2.1/wordcloud2.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Topic modeling and visualization</h1>
            
            <h4 class="date">2022-09-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xiaobaicainiao666/CellFunTopic/blob/master/vignettes/topicmodel_visualization.Rmd"><code>vignettes/topicmodel_visualization.Rmd</code></a></small>
      <div class="hidden name"><code>topicmodel_visualization.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/xiaobaicainiao666/CellFunTopic">CellFunTopic</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">magrittr</span><span class="op">)</span></code></pre></div>
<p>First, please make sure that you have previously performed the
pre-processing and GSEA steps, see <a href="Pre-processing.html">Pre-processing</a>.</p>
<div id="topic-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#topic-modeling" class="anchor"></a>Topic modeling</h2>
<p>Latent Dirichlet Allocation (LDA) is a Bayesian mixture model,
initially developed for the analysis of text documents.
<strong>CellFunTopic</strong> provides a method to fit an LDA model to
the clusters-by-pathways matrix derived from GSEA, where each cluster is
considered as a document, pathway enrichment score(log-transformed) as a
token in the document, and each pathway is considered as a word.
CellFunTopic infers the topic probability distribution by decomposing
the clusters-by-pathways matrix into clusters-by-topics (<code>θ</code>)
and topics-by-pathways (<code>ϕ</code>) matrices, that is, (1) the
probability distributions over the topics for each cluster in the
dataset (<code>θ</code>) and (2) the probability distributions over the
pathways for each topic (<code>ϕ</code>). These distributions indicate,
respectively, how important a regulatory topic is for a cluster
(<code>θ</code>), and how important pathways are for the regulatory
topic (<code>ϕ</code>). We assume that each cluster can be represented
as a mixture of latent topics, which reveal cellular programs shared
across cell types or exclusive to a particular cell type.</p>
<p>Actually, CellFunTopic provides two metrics,
<strong>log-likelihood</strong> and <strong>perplexity</strong>, to
determine the optimal number of topics. But we recommend a customized
number of topics such as the number of cell types in scRNA-seq data, in
order to improve biological interpretability.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html">Idents</a></span><span class="op">(</span><span class="va">SeuratObj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># if k=NULL, the optimal number of topics will be calculated automatically according to log-likelihood and perplexity.</span>
<span class="va">SeuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runLDA.html">runLDA</a></span><span class="op">(</span><span class="va">SeuratObj</span>, by <span class="op">=</span> <span class="st">"GO"</span>, k <span class="op">=</span> <span class="va">k</span>, method <span class="op">=</span> <span class="st">"VEM"</span>, SEED <span class="op">=</span> <span class="fl">1234</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save object for later use.</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">SeuratObj</span>, file <span class="op">=</span> <span class="st">"SeuratObj.RData"</span><span class="op">)</span></code></pre></div>
</div>
<div id="visualization-of-topic-modelling-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization-of-topic-modelling-results" class="anchor"></a>Visualization of topic modelling results</h2>
<p>CellFunTopic provides a few methods to visualize topic modelling
results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ldaOut</span> <span class="op">&lt;-</span> <span class="va">SeuratObj</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">ldaOut</span>
<span class="va">betaDF</span> <span class="op">&lt;-</span> <span class="fu">tidytext</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">ldaOut</span>, matrix <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span>
<span class="va">pws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ID2Description.html">ID2Description</a></span><span class="op">(</span><span class="va">SeuratObj</span>, by <span class="op">=</span> <span class="st">"GO"</span><span class="op">)</span>
<span class="va">betaDF</span> <span class="op">%&lt;&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>descrip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">pws</span><span class="op">[</span><span class="va">term</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">gammaDF</span> <span class="op">&lt;-</span> <span class="fu">tidytext</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">ldaOut</span>, matrix <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show topic distribution on UMAP/TSNE cell map</span>
<span class="fu"><a href="../reference/topicProb.html">topicProb</a></span><span class="op">(</span><span class="va">SeuratObj</span>, reduction<span class="op">=</span><span class="st">"umap"</span>, topic<span class="op">=</span><span class="fl">3</span>, pointSize<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># echart4r network showing top terms of topics with tooltips showing description of pathway ID</span>
<span class="fu"><a href="../reference/topicNW3.html">topicNW3</a></span><span class="op">(</span><span class="va">betaDF</span>, topn<span class="op">=</span><span class="fl">10</span>, pws <span class="op">=</span> <span class="va">pws</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-953166ebc35255323f29" style="width:100%;height:500px;" class="echarts4r html-widget"></div>
<script type="application/json" data-for="htmlwidget-953166ebc35255323f29">{"x":{"theme":"","tl":false,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"series":[{"name":null,"type":"graph","layout":"force","roam":true,"draggable":true,"symbolKeepAspect":true,"focusNodeAdjacency":true,"force":{"repulsion":100},"edgeSymbol":["none","arrow"],"edgeSymbolSize":5,"lineStyle":{"color":"source"},"label":{"show":true,"position":"top","formatter":"\n          function(params) {\n          if (params.value) {\n          const text = params.value.split(\": \")\n          const status = (text[0].substring(0,5) == \"Topic\")? \"ff\" : \"ee\"\n          return(`{${status}|${text[0]}}`)\n          }\n          }\n          ","rich":{"ff":{"borderWidth":0,"padding":0,"fontSize":13},"ee":{"borderWidth":0,"padding":0,"fontSize":8}}},"categories":[{"name":"Topic 1"},{"name":"Topic 2"},{"name":"Topic 3"},{"name":"Topic 4"},{"name":"Topic 5"},{"name":"Topic 6"},{"name":"Topic 7"},{"name":"Topic 8"},{"name":"Topic 9"},{"name":"Topic 10"}],"data":[{"name":"Topic 1","value":"Topic 1","symbolSize":"20","category":"Topic 1"},{"name":"Topic 2","value":"Topic 2","symbolSize":"20","category":"Topic 2"},{"name":"Topic 3","value":"Topic 3","symbolSize":"20","category":"Topic 3"},{"name":"Topic 4","value":"Topic 4","symbolSize":"20","category":"Topic 4"},{"name":"Topic 5","value":"Topic 5","symbolSize":"20","category":"Topic 5"},{"name":"Topic 6","value":"Topic 6","symbolSize":"20","category":"Topic 6"},{"name":"Topic 7","value":"Topic 7","symbolSize":"20","category":"Topic 7"},{"name":"Topic 8","value":"Topic 8","symbolSize":"20","category":"Topic 8"},{"name":"Topic 9","value":"Topic 9","symbolSize":"20","category":"Topic 9"},{"name":"Topic 10","value":"Topic 10","symbolSize":"20","category":"Topic 10"},{"name":"GO:0001775: cell activation","value":"GO:0001775: cell activation","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0001816: cytokine production","value":"GO:0001816: cytokine production","symbolSize":" 5","category":"Topic 1"},{"name":"GO:0002250: adaptive immune response","value":"GO:0002250: adaptive immune response","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002252: immune effector process","value":"GO:0002252: immune effector process","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002253: activation of immune response","value":"GO:0002253: activation of immune response","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002274: myeloid leukocyte activation","value":"GO:0002274: myeloid leukocyte activation","symbolSize":" 5","category":"Topic 1"},{"name":"GO:0002429: immune response-activating cell surface receptor signaling pathway","value":"GO:0002429: immune response-activating cell surface receptor signaling pathway","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002443: leukocyte mediated immunity","value":"GO:0002443: leukocyte mediated immunity","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002460: adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains","value":"GO:0002460: adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002520: immune system development","value":"GO:0002520: immune system development","symbolSize":" 5","category":"Topic 1"},{"name":"GO:0001817: regulation of cytokine production","value":"GO:0001817: regulation of cytokine production","symbolSize":" 5","category":"Topic 2"},{"name":"GO:0002263: cell activation involved in immune response","value":"GO:0002263: cell activation involved in immune response","symbolSize":" 5","category":"Topic 2"},{"name":"GO:0002366: leukocyte activation involved in immune response","value":"GO:0002366: leukocyte activation involved in immune response","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002377: immunoglobulin production","value":"GO:0002377: immunoglobulin production","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0002440: production of molecular mediator of immune response","value":"GO:0002440: production of molecular mediator of immune response","symbolSize":" 5","category":"Topic 3"},{"name":"GO:0044265: cellular macromolecule catabolic process","value":"GO:0044265: cellular macromolecule catabolic process","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0043230: extracellular organelle","value":"GO:0043230: extracellular organelle","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0006955: immune response","value":"GO:0006955: immune response","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0009057: macromolecule catabolic process","value":"GO:0009057: macromolecule catabolic process","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0065003: protein-containing complex assembly","value":"GO:0065003: protein-containing complex assembly","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0070062: extracellular exosome","value":"GO:0070062: extracellular exosome","symbolSize":" 5","category":"Topic 5"},{"name":"GO:1903561: extracellular vesicle","value":"GO:1903561: extracellular vesicle","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0000028: ribosomal small subunit assembly","value":"GO:0000028: ribosomal small subunit assembly","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0022618: ribonucleoprotein complex assembly","value":"GO:0022618: ribonucleoprotein complex assembly","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0071826: ribonucleoprotein complex subunit organization","value":"GO:0071826: ribonucleoprotein complex subunit organization","symbolSize":" 5","category":"Topic 5"},{"name":"GO:0042981: regulation of apoptotic process","value":"GO:0042981: regulation of apoptotic process","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0006928: movement of cell or subcellular component","value":"GO:0006928: movement of cell or subcellular component","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0097028: dendritic cell differentiation","value":"GO:0097028: dendritic cell differentiation","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0051049: regulation of transport","value":"GO:0051049: regulation of transport","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0006952: defense response","value":"GO:0006952: defense response","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0080134: regulation of response to stress","value":"GO:0080134: regulation of response to stress","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0010941: regulation of cell death","value":"GO:0010941: regulation of cell death","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0015850: organic hydroxy compound transport","value":"GO:0015850: organic hydroxy compound transport","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0043067: regulation of programmed cell death","value":"GO:0043067: regulation of programmed cell death","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0008283: cell proliferation","value":"GO:0008283: cell proliferation","symbolSize":" 5","category":"Topic 6"},{"name":"GO:0055081: anion homeostasis","value":"GO:0055081: anion homeostasis","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0009628: response to abiotic stimulus","value":"GO:0009628: response to abiotic stimulus","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0002708: positive regulation of lymphocyte mediated immunity","value":"GO:0002708: positive regulation of lymphocyte mediated immunity","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0002702: positive regulation of production of molecular mediator of immune response","value":"GO:0002702: positive regulation of production of molecular mediator of immune response","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0004620: phospholipase activity","value":"GO:0004620: phospholipase activity","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0048247: lymphocyte chemotaxis","value":"GO:0048247: lymphocyte chemotaxis","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0001913: T cell mediated cytotoxicity","value":"GO:0001913: T cell mediated cytotoxicity","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0030176: integral component of endoplasmic reticulum membrane","value":"GO:0030176: integral component of endoplasmic reticulum membrane","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0030101: natural killer cell activation","value":"GO:0030101: natural killer cell activation","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0002709: regulation of T cell mediated immunity","value":"GO:0002709: regulation of T cell mediated immunity","symbolSize":" 5","category":"Topic 7"},{"name":"GO:0036230: granulocyte activation","value":"GO:0036230: granulocyte activation","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0051240: positive regulation of multicellular organismal process","value":"GO:0051240: positive regulation of multicellular organismal process","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0046649: lymphocyte activation","value":"GO:0046649: lymphocyte activation","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0032970: regulation of actin filament-based process","value":"GO:0032970: regulation of actin filament-based process","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0016477: cell migration","value":"GO:0016477: cell migration","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0071396: cellular response to lipid","value":"GO:0071396: cellular response to lipid","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0072593: reactive oxygen species metabolic process","value":"GO:0072593: reactive oxygen species metabolic process","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0045089: positive regulation of innate immune response","value":"GO:0045089: positive regulation of innate immune response","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0060627: regulation of vesicle-mediated transport","value":"GO:0060627: regulation of vesicle-mediated transport","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0006909: phagocytosis","value":"GO:0006909: phagocytosis","symbolSize":" 5","category":"Topic 8"},{"name":"GO:0034612: response to tumor necrosis factor","value":"GO:0034612: response to tumor necrosis factor","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0071356: cellular response to tumor necrosis factor","value":"GO:0071356: cellular response to tumor necrosis factor","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0005125: cytokine activity","value":"GO:0005125: cytokine activity","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0070232: regulation of T cell apoptotic process","value":"GO:0070232: regulation of T cell apoptotic process","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0098857: membrane microdomain","value":"GO:0098857: membrane microdomain","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0045121: membrane raft","value":"GO:0045121: membrane raft","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0098589: membrane region","value":"GO:0098589: membrane region","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0070231: T cell apoptotic process","value":"GO:0070231: T cell apoptotic process","symbolSize":" 5","category":"Topic 9"},{"name":"GO:1990868: response to chemokine","value":"GO:1990868: response to chemokine","symbolSize":" 5","category":"Topic 9"},{"name":"GO:1990869: cellular response to chemokine","value":"GO:1990869: cellular response to chemokine","symbolSize":" 5","category":"Topic 9"},{"name":"GO:0002684: positive regulation of immune system process","value":"GO:0002684: positive regulation of immune system process","symbolSize":" 5","category":"Topic 10"}],"links":[{"source":"Topic 1","target":"GO:0001775: cell activation"},{"source":"Topic 1","target":"GO:0001816: cytokine production"},{"source":"Topic 1","target":"GO:0002250: adaptive immune response"},{"source":"Topic 1","target":"GO:0002252: immune effector process"},{"source":"Topic 1","target":"GO:0002253: activation of immune response"},{"source":"Topic 1","target":"GO:0002274: myeloid leukocyte activation"},{"source":"Topic 1","target":"GO:0002429: immune response-activating cell surface receptor signaling pathway"},{"source":"Topic 1","target":"GO:0002443: leukocyte mediated immunity"},{"source":"Topic 1","target":"GO:0002460: adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains"},{"source":"Topic 1","target":"GO:0002520: immune system development"},{"source":"Topic 2","target":"GO:0001775: cell activation"},{"source":"Topic 2","target":"GO:0001816: cytokine production"},{"source":"Topic 2","target":"GO:0001817: regulation of cytokine production"},{"source":"Topic 2","target":"GO:0002252: immune effector process"},{"source":"Topic 2","target":"GO:0002253: activation of immune response"},{"source":"Topic 2","target":"GO:0002263: cell activation involved in immune response"},{"source":"Topic 2","target":"GO:0002274: myeloid leukocyte activation"},{"source":"Topic 2","target":"GO:0002366: leukocyte activation involved in immune response"},{"source":"Topic 2","target":"GO:0002429: immune response-activating cell surface receptor signaling pathway"},{"source":"Topic 2","target":"GO:0002443: leukocyte mediated immunity"},{"source":"Topic 3","target":"GO:0001775: cell activation"},{"source":"Topic 3","target":"GO:0002250: adaptive immune response"},{"source":"Topic 3","target":"GO:0002252: immune effector process"},{"source":"Topic 3","target":"GO:0002253: activation of immune response"},{"source":"Topic 3","target":"GO:0002366: leukocyte activation involved in immune response"},{"source":"Topic 3","target":"GO:0002377: immunoglobulin production"},{"source":"Topic 3","target":"GO:0002429: immune response-activating cell surface receptor signaling pathway"},{"source":"Topic 3","target":"GO:0002440: production of molecular mediator of immune response"},{"source":"Topic 3","target":"GO:0002443: leukocyte mediated immunity"},{"source":"Topic 3","target":"GO:0002460: adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains"},{"source":"Topic 4","target":"GO:0001775: cell activation"},{"source":"Topic 4","target":"GO:0001816: cytokine production"},{"source":"Topic 4","target":"GO:0001817: regulation of cytokine production"},{"source":"Topic 4","target":"GO:0002250: adaptive immune response"},{"source":"Topic 4","target":"GO:0002252: immune effector process"},{"source":"Topic 4","target":"GO:0002253: activation of immune response"},{"source":"Topic 4","target":"GO:0002263: cell activation involved in immune response"},{"source":"Topic 4","target":"GO:0002274: myeloid leukocyte activation"},{"source":"Topic 4","target":"GO:0002366: leukocyte activation involved in immune response"},{"source":"Topic 4","target":"GO:0002443: leukocyte mediated immunity"},{"source":"Topic 5","target":"GO:0044265: cellular macromolecule catabolic process"},{"source":"Topic 5","target":"GO:0043230: extracellular organelle"},{"source":"Topic 5","target":"GO:0006955: immune response"},{"source":"Topic 5","target":"GO:0009057: macromolecule catabolic process"},{"source":"Topic 5","target":"GO:0065003: protein-containing complex assembly"},{"source":"Topic 5","target":"GO:0070062: extracellular exosome"},{"source":"Topic 5","target":"GO:1903561: extracellular vesicle"},{"source":"Topic 5","target":"GO:0000028: ribosomal small subunit assembly"},{"source":"Topic 5","target":"GO:0022618: ribonucleoprotein complex assembly"},{"source":"Topic 5","target":"GO:0071826: ribonucleoprotein complex subunit organization"},{"source":"Topic 6","target":"GO:0042981: regulation of apoptotic process"},{"source":"Topic 6","target":"GO:0006928: movement of cell or subcellular component"},{"source":"Topic 6","target":"GO:0097028: dendritic cell differentiation"},{"source":"Topic 6","target":"GO:0051049: regulation of transport"},{"source":"Topic 6","target":"GO:0006952: defense response"},{"source":"Topic 6","target":"GO:0080134: regulation of response to stress"},{"source":"Topic 6","target":"GO:0010941: regulation of cell death"},{"source":"Topic 6","target":"GO:0015850: organic hydroxy compound transport"},{"source":"Topic 6","target":"GO:0043067: regulation of programmed cell death"},{"source":"Topic 6","target":"GO:0008283: cell proliferation"},{"source":"Topic 7","target":"GO:0055081: anion homeostasis"},{"source":"Topic 7","target":"GO:0009628: response to abiotic stimulus"},{"source":"Topic 7","target":"GO:0002708: positive regulation of lymphocyte mediated immunity"},{"source":"Topic 7","target":"GO:0002702: positive regulation of production of molecular mediator of immune response"},{"source":"Topic 7","target":"GO:0004620: phospholipase activity"},{"source":"Topic 7","target":"GO:0048247: lymphocyte chemotaxis"},{"source":"Topic 7","target":"GO:0001913: T cell mediated cytotoxicity"},{"source":"Topic 7","target":"GO:0030176: integral component of endoplasmic reticulum membrane"},{"source":"Topic 7","target":"GO:0030101: natural killer cell activation"},{"source":"Topic 7","target":"GO:0002709: regulation of T cell mediated immunity"},{"source":"Topic 8","target":"GO:0036230: granulocyte activation"},{"source":"Topic 8","target":"GO:0051240: positive regulation of multicellular organismal process"},{"source":"Topic 8","target":"GO:0046649: lymphocyte activation"},{"source":"Topic 8","target":"GO:0032970: regulation of actin filament-based process"},{"source":"Topic 8","target":"GO:0016477: cell migration"},{"source":"Topic 8","target":"GO:0071396: cellular response to lipid"},{"source":"Topic 8","target":"GO:0072593: reactive oxygen species metabolic process"},{"source":"Topic 8","target":"GO:0045089: positive regulation of innate immune response"},{"source":"Topic 8","target":"GO:0060627: regulation of vesicle-mediated transport"},{"source":"Topic 8","target":"GO:0006909: phagocytosis"},{"source":"Topic 9","target":"GO:0034612: response to tumor necrosis factor"},{"source":"Topic 9","target":"GO:0071356: cellular response to tumor necrosis factor"},{"source":"Topic 9","target":"GO:0005125: cytokine activity"},{"source":"Topic 9","target":"GO:0070232: regulation of T cell apoptotic process"},{"source":"Topic 9","target":"GO:0098857: membrane microdomain"},{"source":"Topic 9","target":"GO:0045121: membrane raft"},{"source":"Topic 9","target":"GO:0098589: membrane region"},{"source":"Topic 9","target":"GO:0070231: T cell apoptotic process"},{"source":"Topic 9","target":"GO:1990868: response to chemokine"},{"source":"Topic 9","target":"GO:1990869: cellular response to chemokine"},{"source":"Topic 10","target":"GO:0001816: cytokine production"},{"source":"Topic 10","target":"GO:0001817: regulation of cytokine production"},{"source":"Topic 10","target":"GO:0002250: adaptive immune response"},{"source":"Topic 10","target":"GO:0002253: activation of immune response"},{"source":"Topic 10","target":"GO:0002263: cell activation involved in immune response"},{"source":"Topic 10","target":"GO:0002274: myeloid leukocyte activation"},{"source":"Topic 10","target":"GO:0002366: leukocyte activation involved in immune response"},{"source":"Topic 10","target":"GO:0002429: immune response-activating cell surface receptor signaling pathway"},{"source":"Topic 10","target":"GO:0002443: leukocyte mediated immunity"},{"source":"Topic 10","target":"GO:0002684: positive regulation of immune system process"}]}],"legend":{"data":["Topic 1","Topic 2","Topic 3","Topic 4","Topic 5","Topic 6","Topic 7","Topic 8","Topic 9","Topic 10"],"show":true,"type":"plain","right":0,"top":20},"tooltip":{"trigger":"item","formatter":"\n          function(params) {\n          if (params.value) {\n          const text = params.value.split(\": \")\n          const label = (text[0].substring(0,5) == \"Topic\")? text[0] : `${text[0]}<br>${text[1]}`\n          return(label)\n          }\n          }\n          "},"title":[{"text":"Top 10 terms of 10 Topics"}],"toolbox":{"feature":{"saveAsImage":[],"dataView":[]}}},"dispose":true},"evals":["opts.series.0.label.formatter","opts.tooltip.formatter"],"jsHooks":[]}</script><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Heatmap showing probability between topics and clusters</span>
<span class="fu"><a href="../reference/cluster_topic_hmp.html">cluster_topic_hmp</a></span><span class="op">(</span><span class="va">ldaOut</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sankey diagram showing the best assigned topic of each cluster</span>
<span class="fu"><a href="../reference/plot_sankey.html">plot_sankey</a></span><span class="op">(</span><span class="va">gammaDF</span>, topn<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-4e847e77bd12b71e77e0" style="width:800px;height:600px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4e847e77bd12b71e77e0">{"x":{"links":{"source":[9,3,4,2,5,1,6,8,7,0],"target":[10,18,11,12,13,14,14,15,16,17],"value":[0.999966380065291,0.999975789927916,0.999973672965599,0.999949661118673,0.999974439472456,0.999956126563576,0.940765526002789,0.873095829850331,0.851764295152561,0.999974522661391],"group":["Topic_1","Topic_10","Topic_2","Topic_3","Topic_4","Topic_5","Topic_5","Topic_6","Topic_7","Topic_9"]},"nodes":{"name":["0","1","2","3","4","5","6","7","8","9","Topic_1","Topic_2","Topic_3","Topic_4","Topic_5","Topic_6","Topic_7","Topic_9","Topic_10"],"group":["0","1","2","3","4","5","6","7","8","9","Topic_1","Topic_2","Topic_3","Topic_4","Topic_5","Topic_6","Topic_7","Topic_9","Topic_10"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":"topic","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># word cloud of top terms of topic</span>
<span class="fu"><a href="../reference/wordcloud_topic.html">wordcloud_topic</a></span><span class="op">(</span><span class="va">betaDF</span>, <span class="va">pws</span>, topic<span class="op">=</span><span class="fl">3</span>, topn<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3D word cloud of top terms of topic</span>
<span class="fu"><a href="../reference/wordcloud_topic.html">wordcloud_topic_3D</a></span><span class="op">(</span><span class="va">betaDF</span>, <span class="va">pws</span>, topic<span class="op">=</span><span class="fl">3</span>, topn<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b94b289fc971d78f6ab8" style="width:672px;height:672px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-b94b289fc971d78f6ab8">{"x":{"word":["cell activation","adaptive immune response","immune effector process","activation of immune response","leukocyte activation involved in immune response","immunoglobulin production","immune response-activating cell surface receptor signaling pathway","production of molecular mediator of immune response","leukocyte mediated immunity","adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains","immune system development","leukocyte differentiation","regulation of immune system process","positive regulation of immune system process","regulation of leukocyte activation","positive regulation of leukocyte activation","immune response-activating signal transduction","immune response-regulating signaling pathway","immune response-regulating cell surface receptor signaling pathway","transmembrane signaling receptor activity"],"freq":[0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107,0.00267952840300107],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":6717.6,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Heatmap showing cosine similarity between topics</span>
<span class="fu"><a href="../reference/cosineheatmap.html">cosineheatmap</a></span><span class="op">(</span><span class="va">ldaOut</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Heatmap showing cosine similarity between clusters</span>
<span class="fu"><a href="../reference/cosinehmp_cluster.html">cosinehmp_cluster</a></span><span class="op">(</span><span class="va">ldaOut</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-13-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Network showing cosine similarity between clusters</span>
<span class="fu"><a href="../reference/cosine_network_cluster.html">cosine_network_cluster</a></span><span class="op">(</span><span class="va">ldaOut</span>, layout<span class="op">=</span><span class="st">"fr"</span>, cos_sim_thresh<span class="op">=</span><span class="fl">0.02</span>, SEED<span class="op">=</span><span class="fl">123</span>, radius<span class="op">=</span><span class="fl">0.12</span>, width_range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Network of cosine similarity between terms</span>
<span class="fu"><a href="../reference/cosine_network_term.html">cosine_network_term</a></span><span class="op">(</span><span class="va">SeuratObj</span>, cosine_cal_by <span class="op">=</span> <span class="st">"Topic modeling"</span>, pie_by <span class="op">=</span> <span class="st">"Topic modeling"</span>, GSEA_by <span class="op">=</span> <span class="st">"GO"</span>,
   topn <span class="op">=</span> <span class="fl">10</span>, layout <span class="op">=</span> <span class="st">"fr"</span>, cos_sim_thresh <span class="op">=</span> <span class="fl">0.8</span>, radius <span class="op">=</span> <span class="fl">0.1</span>, text_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># UMAP on cluster-topic probability matrix</span>
<span class="fu"><a href="../reference/umap_cluster.html">umap_cluster</a></span><span class="op">(</span><span class="va">ldaOut</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show top terms of each topic</span>
<span class="fu"><a href="../reference/Topterms_Topic.html">Topterms_Topic</a></span><span class="op">(</span><span class="va">betaDF</span>, Topic <span class="op">=</span> <span class="fl">3</span>, topn <span class="op">=</span> <span class="fl">10</span>, text.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># barplot to show top terms of every topic</span>
<span class="fu"><a href="../reference/hist_topic_term.html">hist_topic_term</a></span><span class="op">(</span><span class="va">betaDF</span>, topics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, topn<span class="op">=</span><span class="fl">20</span>, axis.text.y.size<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># barplot to show probability of assigned topics in clusters</span>
<span class="fu"><a href="../reference/hist_cluster_topic.html">hist_cluster_topic</a></span><span class="op">(</span><span class="va">gammaDF</span>, clusters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html">Idents</a></span><span class="op">(</span><span class="va">SeuratObj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="topicmodel_visualization_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shanni Cao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
